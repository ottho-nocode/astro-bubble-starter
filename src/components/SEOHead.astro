---
interface Props {
  title: string;
  description: string;
  image?: string;
  canonicalUrl?: string;
  type?: "website" | "article";
  publishedDate?: string;
}

const {
  title,
  description,
  image,
  canonicalUrl,
  type = "website",
  publishedDate,
} = Astro.props;

const siteName = "Ottho";
const siteUrl = "https://ottho.co";

const fullTitle = `${title} | ${siteName}`;
const canonical = canonicalUrl || Astro.url.href;
const ogImage = image || `${siteUrl}/og-default.png`;

const schemaGraph = [
  {
    "@type": "Organization",
    "@id": `${siteUrl}/#organization`,
    name: siteName,
    url: siteUrl,
    logo: `${siteUrl}/logo-ottho.svg`,
    sameAs: [
      "https://www.linkedin.com/school/ottho/",
      "https://www.youtube.com/@ottho_nocode",
      "https://www.instagram.com/ottho.nocode/",
    ],
  },
  {
    "@type": "EducationalOrganization",
    "@id": `${siteUrl}/#school`,
    name: siteName,
    url: siteUrl,
    description: "L'école en ligne N°1 sur Bubble en France. Formations No Code finançables CPF.",
  },
  {
    "@type": "AggregateRating",
    "@id": `${siteUrl}/#rating`,
    itemReviewed: { "@id": `${siteUrl}/#school` },
    ratingValue: "5.0",
    reviewCount: "172",
    bestRating: "5",
    worstRating: "1",
  },
  {
    "@type": "Course",
    name: "Bootcamp Bubble Developer",
    description: "Formation intensive pour devenir développeur No Code sur Bubble.io",
    provider: { "@id": `${siteUrl}/#school` },
    educationalLevel: "Beginner to Advanced",
    inLanguage: "fr",
    offers: {
      "@type": "Offer",
      category: "Finançable CPF",
      availability: "https://schema.org/InStock",
    },
  },
  {
    "@type": "Course",
    name: "Formation Product Launcher",
    description: "Lancez votre startup avec le No Code et Bubble.io",
    provider: { "@id": `${siteUrl}/#school` },
    educationalLevel: "Beginner",
    inLanguage: "fr",
    offers: {
      "@type": "Offer",
      category: "Finançable CPF",
      availability: "https://schema.org/InStock",
    },
  },
  {
    "@type": "WebSite",
    "@id": `${siteUrl}/#website`,
    url: siteUrl,
    name: siteName,
    inLanguage: "fr",
    publisher: { "@id": `${siteUrl}/#organization` },
  },
];

const jsonLd = JSON.stringify({ "@context": "https://schema.org", "@graph": schemaGraph });
---

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="sitemap" href="/sitemap-index.xml" />
<link rel="canonical" href={canonical} />
<link rel="alternate" hreflang="fr" href={canonical} />

<!-- Preconnect -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

<title>{fullTitle}</title>
<meta name="description" content={description} />
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />

<!-- Open Graph -->
<meta property="og:type" content={type} />
<meta property="og:title" content={fullTitle} />
<meta property="og:description" content={description} />
<meta property="og:url" content={canonical} />
<meta property="og:image" content={ogImage} />
<meta property="og:site_name" content={siteName} />
<meta property="og:locale" content="fr_FR" />
{publishedDate && <meta property="article:published_time" content={publishedDate} />}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={fullTitle} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImage} />

<!-- Schema.org JSON-LD -->
<script type="application/ld+json" set:html={jsonLd} />
