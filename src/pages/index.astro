---
export const prerender = false;

import Base from "../layouts/Base.astro";
import HeroVitrine from "../components/HeroVitrine.astro";
import DescriptionSection from "../components/DescriptionSection.astro";
import BlogPreview from "../components/BlogPreview.astro";
import ContactSection from "../components/ContactSection.astro";
import { getCompanyInfo } from "../lib/bubble";
import { setLandingConfigFromCompany } from "../lib/landing-config";

const company = await getCompanyInfo();
if (company) setLandingConfigFromCompany(company);
const title = company ? `${company.nom} â€” ${company.slogan || "Accueil"}` : "Accueil";
const description = company?.description?.slice(0, 160) || "";
---

<Base title={title} description={description}>
  {company ? (
    <>
      <HeroVitrine company={company} />
      <DescriptionSection description={company.description} />
      <BlogPreview />
      <ContactSection company={company} />
    </>
  ) : (
    <div class="py-32 text-center text-gray-500">
      <p>Aucune information disponible.</p>
    </div>
  )}
</Base>
